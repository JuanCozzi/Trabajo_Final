{% extends "base.html" %}

{% block title %}Device dashboard{% endblock %}

{% block included_scripts %}
{% load static %}
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<!-- <script src="https://d3js.org/d3.v5.min.js"></script> -->
	<script src="{% static 'controller/user_dashboard.js' %}"></script>
{% endblock %}

{% block content %}
	<div class="row">
		<div class="col-sm-3">
		</div>
		<div class="col-sm-6">
			<div class="row text-center">
				<h1>Devices available</h1>
			</div>
				
				{% for user_device in user_devices %}
					<div class="row">
						<button type="button" class="btn btn-outline-primary" data-device-id="{{user_device.id}}"
							onclick="deviceSelected(this.dataset.deviceId)">
							{% if user_device.name is None %}
								{{user_device.id}}
							{% else %}
								{{user_device.name}}
							{% endif %}
							<span class="small-dot {% if user_device.connected %} on {% else %} off {% endif %}"
								data-toggle="tooltip" title="Device{% if user_device.connected %} on {% else %} off {% endif %}">
							</span>
							
						</button>
					</div>
				{% endfor %}
			</div>
		</div>
		<div class="col-sm-3">
		</div>

	</div>



	<!-- Edit Modal HTML -->
	<div id="editTempModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<!-- <form> -->
					<div class="modal-header">
						<h4 class="modal-title">Change desired temperature</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label>Current temperature: <span id="currentTemperature"></span></label>
						</div>
						<div class="form-group">
							<label>New temperature</label>
							<input type="text" class="form-control" id="newTemperature" required>
						</div>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
						<input type="submit" class="btn btn-info" data-dismiss="modal" value="Save" id="editTemperature">
					</div>
				<!-- </form> -->
			</div>
		</div>
	</div>
{% endblock %}

{% block script %}
	var user_devices = []
	{% for user_device in user_devices %}
		user_devices.push({
			id: "{{user_device.id}}",
			name: {% if user_device.name is None %} null {% else %} "{{user_device.name}}" {% endif %},
			connected: {% if user_device.connected %} true {% else %} false {% endif %},
		})
	{% endfor %}
	var user_dashboard_url = "{% url 'user_dashboard' %}"
	var device_dashboard_url = "{% url 'device_dashboard' 123 %}"
{% endblock %}
